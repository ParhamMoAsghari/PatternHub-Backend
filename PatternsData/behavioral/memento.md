# الگوی ممنتو (Memento Pattern)

### همچنین شناخته شده به عنوان:
- Snapshot (گرفتن تصویر)

### انگیزه (Motivation):
الگوی ممنتو در نرم‌افزارها استفاده می‌شود وقتی که بخواهیم وضعیت یک شیء را در زمانی خاص ذخیره کنیم و در آینده به آن وضعیت بازگردیم. این الگو به ما امکان می‌دهد تا وضعیت یک شیء را در یک زمان خاص ذخیره کرده و در آینده به آن وضعیت برگردیم.

### قابلیت استفاده (Applicability):
الگوی ممنتو وقتی مناسب است که:
- می‌خواهیم وضعیت یک شیء را در یک زمان خاص ذخیره کنیم و در آینده به آن وضعیت برگردیم.
- نیاز داریم تا قابلیت بازگرداندن وضعیت یک شیء را فراهم کنیم بدون اینکه جزئیات آن وضعیت به دیگران آشکار شود.

### ساختار (Structure):
الگوی ممنتو شامل موارد زیر است:
- `Originator`: شیء اصلی که وضعیت را دارد و قابلیت ذخیره و بازگرداندن وضعیت را فراهم می‌کند.
- `Memento`: شیءی که وضعیت را نگهداری می‌کند.
- `Caretaker`: مسئول مدیریت ممنتوها است و می‌تواند ممنتوها را ذخیره کند و به آنها دسترسی داشته باشد.

### شرکت‌کنندگان (Participants):
- `Originator`: شیء اصلی که وضعیت را دارد و قابلیت ذخیره و بازگرداندن وضعیت را فراهم می‌کند.
- `Memento`: شیءی که وضعیت را نگهداری می‌کند و توسط `Originator` ساخته و مدیریت می‌شود.
- `Caretaker`: مسئول مدیریت ممن

توها است و می‌تواند ممنتوها را ذخیره کند و به آنها دسترسی داشته باشد.

### همکاری (Collaborations):
- هنگامی که `Originator` می‌خواهد وضعیت را ذخیره کند، یک `Memento` ایجاد می‌کند و وضعیت فعلی خود را به آن منتقل می‌کند. سپس `Memento` را به `Caretaker` ارسال می‌کند و آن را ذخیره می‌کند.
- هنگامی که `Originator` می‌خواهد وضعیت خود را بازگرداند، از `Caretaker` درخواست `Memento` مربوطه را می‌دهد و وضعیت مربوطه را از `Memento` دریافت می‌کند و خود را بازگردانی می‌کند.

### پیامدها (Consequences):
استفاده از الگوی ممنتو دارای مزایا و معایب زیر است:
- **مزایا**:
    - امکان ذخیره و بازگرداندن وضعیت یک شیء در زمان خاص.
    - جدا بودن شیء اصلی (`Originator`) از مسئولیت ذخیره و بازگرداندن وضعیت.
    - امکان حفظ اصلیت (`Encapsulation`) و انتزاع (`Abstraction`) شیء اصلی.

- **معایب**:
    - ممکن است ذخیره کردن و بازگرداندن وضعیت‌ها هزینه بالایی داشته باشد اگر حجم داده بزرگی ذخیره شود.
    - نیاز به مدیریت ممنتوها و حفظ زمانی که هر ممنتو ایجاد شده است.

### پیاده‌سازی (Implementation):
در زبان برنامه‌نویسی C#، می‌توانیم الگوی ممنتو را به صورت زیر پیاده‌سازی کنیم:

```csharp
// Originator
public class Originator
{
    private string state;

    public void SetState(string state)
    {
        this.state = state;
    }

    public string GetState()
    {
        return state;
    }

    public Memento SaveStateToMemento()
    {
        return new Memento(state);
    }

    public void RestoreStateFromMemento(Memento memento)
    {
        state

 = memento.GetState();
    }
}

// Memento
public class Memento
{
    private readonly string state;

    public Memento(string state)
    {
        this.state = state;
    }

    public string GetState()
    {
        return state;
    }
}

// Caretaker
public class Caretaker
{
    private Memento memento;

    public void SetMemento(Memento memento)
    {
        this.memento = memento;
    }

    public Memento GetMemento()
    {
        return memento;
    }
}
```

### استفاده‌های شناخته شده (Known Uses):
استفاده از الگوی ممنتو در بسیاری از برنامه‌ها و فریمورک‌ها وجود دارد. برای مثال، در برنامه‌های ویرایشگر متن، ممکن است میخواهیم تغییرات را ذخیره کنیم تا بتوانیم به حالت قبلی بازگردیم و تغییرات را لغو کنیم.

### الگوهای مرتبط (Related Patterns):
- **Command Pattern**: Command Pattern و الگوی ممنتو هر دو الگوهایی هستند که مربوط به مدیریت عملیات و بازگرداندن آنها هستند. با این حال، Command Pattern بر روی اعمال یک عملکرد خاص تمرکز دارد، در حالی که الگوی ممنتو بر روی بازگرداندن وضعیت یک شیء تمرکز دارد.
- **Iterator Pattern**: Iterator Pattern و الگوی ممنتو هر دو الگوهایی هستند که مرتبط به پیمایش و ذخیره وضعیت راه‌اندازی و پیمایش می‌کنند.