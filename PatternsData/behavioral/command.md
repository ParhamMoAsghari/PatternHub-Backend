# الگوی دستور (Command Pattern)

### همچنین شناخته شده به عنوان:
- Action Pattern

### انگیزه (Motivation):
الگوی دستور در نرم‌افزارها استفاده می‌شود تا عملیات‌ها یا درخواست‌ها را به عنوان یک شیء بپذیرند، به صورتی که بتوانیم آن‌ها را ذخیره کنیم، در صف قرار دهیم، لغو یا بازیابی کنیم و به صورت پویا عملکرد را تغییر دهیم.

### قابلیت استفاده (Applicability):
الگوی دستور مناسب است که:
- می‌خواهید درخواست‌ها را به عنوان یک شیء مدل کنید و قابلیت لغو و بازیابی آن‌ها را داشته باشید.
- می‌خواهید عملیات‌ها را صفی از درخواست‌ها در نظر بگیرید و آن‌ها را به ترتیب اجرا کنید.
- می‌خواهید عملکرد سیستم را به صورت پویا تغییر دهید و عملیات‌ها را قابل ترکیب کنید.

### ساختار (Structure):
الگوی دستور شامل موارد زیر است:
- `Command`: رابطی است که تمام دستورات باید پیاده‌سازی کنند.
- `ConcreteCommand`: کلاس‌هایی که دستورات خاص را پیاده‌سازی می‌کنند و به عنوان نمونه‌های واقعی از `Command` استفاده می‌شوند.
- `Invoker`: کلاسی است که دستورات را فراخوانی می‌کند و اجرای آن‌ها را از دستوران می‌خواهد.
- `Receiver`: کلاسی است که عملیات‌های مربوط به دستور را انجام می‌دهد.

### شرکت‌کنندگان (Participants):
- `Command`: رابطی که تمام دستورات باید پیاده‌سازی کنند.
- `ConcreteCommand`: کلاس‌هایی که دستورات خاص را پیاده‌سازی می‌کنند.
- `Invoker`: کلاسی که دستورات را فراخوانی

می‌کند.
- `Receiver`: کلاسی که عملیات‌های مربوط به دستور را انجام می‌دهد.

### همکاری (Collaborations):
- `Invoker` با استفاده از `Command` درخواست‌ها را فراخوانی می‌کند.
- هر `ConcreteCommand` نیاز به یک یا چند `Receiver` دارد تا عملیات مربوطه را انجام دهد.

### پیامدها (Consequences):
استفاده از الگوی دستور دارای مزایا و معایب زیر است:
- **مزایا**:
    - جداسازی دستورات و اجراگران: دستورات مستقل از اجراگران هستند و می‌توانند به ترتیب دلخواهی اجرا شوند.
    - امکان لغو، بازیابی و ترکیب دستورات: می‌توان دستورات را در صف قرار داده و آن‌ها را بازیابی و لغو کرد. همچنین می‌توان دستورات را با یکدیگر ترکیب کرد و عملیات پیچیده‌تری را انجام داد.
    - ساده‌سازی ساختار کد: با استفاده از الگوی دستور، کد قابل خواندن‌تر، قابل نگهداری‌تر و قابل توسعه‌تر می‌شود.

- **معایب**:
    - افزایش تعداد کلاس‌ها: استفاده از الگوی دستور ممکن است تعداد کلاس‌ها را افزایش دهد و باعث پیچیدگی بیشتری در کد شود.

### پیاده‌سازی (Implementation):
در زبان برنامه‌نویسی C#، می‌توانیم الگوی دستور را به صورت زیر پیاده‌سازی کنیم:

```csharp
// Command
public interface ICommand
{
    void Execute();
}

// ConcreteCommand
public class ConcreteCommand : ICommand
{
    private readonly Receiver _receiver;

    public ConcreteCommand(Receiver receiver)
    {
        _receiver = receiver;
    }

    public void Execute()
    {
        _receiver.Action();
    }
}

// Invoker
public class Invoker
{
    private readonly List<ICommand> _commands;

    public Invoker()
    {
        _commands = new List<ICommand>();
    }

    public void AddCommand(ICommand command)
    {
        _commands.Add(command);
    }

    public void ExecuteCommands()
    {
       

 foreach (var command in _commands)
        {
            command.Execute();
        }
    }
}

// Receiver
public class Receiver
{
    public void Action()
    {
        Console.WriteLine("Receiver Action called");
    }
}
```

### استفاده‌های شناخته شده (Known Uses):
الگوی دستور در موارد زیر استفاده می‌شود:
- پیاده‌سازی برنامه‌های مدیریت دستورات و رابط کاربری گرافیکی (GUI).
- سیستم‌های بازی که نیاز به کنترل واکنش‌های کاربر دارند.
- سیستم‌های تراکنشی و انجام عملیات مالی.

### الگوهای مرتبط (Related Patterns):
- **Composite Pattern**: می‌توان الگوی دستور را با الگوی Composite ترکیب کرد تا درخواست‌ها را سازماندهی و سلسله‌مراتبی کنیم.
- **Memento Pattern**: الگوی دستور می‌تواند با الگوی Memento برای ذخیره و بازیابی وضعیت قبلی سیستم استفاده شود.